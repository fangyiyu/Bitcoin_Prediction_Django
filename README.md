# Capstone report

## Problem statement

The capstone project aims to build a web application that gives authenticated users access to predicting Bitcoin price in a specific time period, more specifically, seven days from the users' login date. Considering confidence intervals, three predicted values are generated for the chosen date. In this case, users can compare the predicted price, the interactive graph of historical bitcoin price, and their buying price (if possible) to make trading decisions. 

## Structure of the Django Project

<p align="center">
  <img width="350" src="https://github.com/fangyiyu/Bitcoin/blob/master/structure.png">
</p>

- One Django model (User) is built. It lets users register, log in, and log out together with storing the corresponding information. 
- In plots.py, three functions are defined, including data() which fetches real-life time-series data from the [Binance API](https://python-binance.readthedocs.io/en/latest/) and performs preprocessing; predict() which uses [Prophet](https://facebook.github.io/prophet/) from Facebook for the machine learning forecasting task in the backend. As an MSc. student with a research interest in machine learning, I have experimented with different time series prediction models, including LSTM, ARIMA, and Prophet. Prophet turned out to be more accurate by just utilizing time and historical price data as input. Hence the proposed model here is Prophet. The last is graph(), which plots an interactive graph of the historical and projected price of Bitcoin using [Plotly](https://plotly.com/python/getting-started/), as shown below.

<p align="center">
  <img width="800" src="https://github.com/fangyiyu/Bitcoin/blob/master/graph.png">
</p>
 
- After a user logged in, she will see her name in the up left of the main page (index.html), a real-time bitcoin price chart fetched by [Bitcoin.com API](https://developer.bitcoin.com/bitcoincom-link/docs/getting-started) and a form to let her choose a date to predict, the date range is limited to seven days from "today" because of the parameter setting in the Machine learning model, so any date beyond the setting will be disabled (not clickable). After clicking the predict button, the page needs a while to load since the ML model needs time to converge. A preloader screen is set on clicking the predict button for a better user experience. After the convergence of the Machine Learning model on the backend, the user will be able to click on the default, best and worst button to see the predicted price of bitcoin on the specific date the user chose in three different scenarios: the most likely scenario, the best and the worst scenarios. These three values correspond to the yhat, yhat_upper, and yhat_lower values resulting from the Prophet Model. Users will be able to see the explanations of these three buttons by hovering on them.  


<p align="center">
  <img width="800" src="https://github.com/fangyiyu/Bitcoin/blob/master/home_page.png">
</p>

- In views.py, a Graph view is created to pass the graph generated by Plotly to index.html; a predict view is created to pass the predicted values from the Forecasting model to the Html files. Furthermore, Index, logout_view, login_view, and register views are created for user authentication. 

## Run the application
- Create a virtual environment by ``` virtualenv <my_env_name>```
- Activate the env by ```<my_env_name>/bin/activate```
- Clone my Repo by ``` git clone <the https of the repo>```
- Get into the dir where manage.py is by ```cd pred_bitcoin_v2```
- Install required packages by ``` pip install -r requirements.txt```. This step may take a while, since the pystan and prophet packages may take approximately up to three minutes. You may encounter "Failed building wheel for prophet", but the package will ultimately been installed.
- Make migrations by ``` python3 manage.py makemigrates```, then ``` python3 manage.py migrate```
- Run the application by ``` python3 manage.py runserver```


## Deployment
I have configured the application a bit by adding some interactive user interface features and deleting the User model. In this case, any user can have access to the application instead of just authenticated users.  
I have deployed this version on Heroku, and here is the live [demo](https://predbit.herokuapp.com/).
